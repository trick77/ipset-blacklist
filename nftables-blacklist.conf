# nftables-blacklist configuration
# https://github.com/trick77/nftables-blacklist
#
# Most settings have sensible defaults. Override only what you need.
# See README.md for all available options.

#=== FILE PATHS ===#
# Directory must exist (won't be created automatically)

IP_BLACKLIST=/etc/nftables-blacklist/ip-blacklist.list
NFT_BLACKLIST_SCRIPT=/etc/nftables-blacklist/blacklist.nft

#=== BEHAVIOR ===#

VERBOSE=yes    # Show progress output
FORCE=yes      # Auto-create nftables table/sets if missing

#=== BLACKLISTS ===#
# URLs to download. Supports: https://, http://, file:///
# Both IPv4 and IPv6 addresses are automatically extracted

BLACKLISTS=(
  # Local custom list (uncomment to use)
  # "file:///etc/nftables-blacklist/custom.list"

  # Project Honey Pot - Dictionary Attacker IPs
  "https://www.projecthoneypot.org/list_of_ips.php?t=d&rss=1"

  # BruteForceBlocker IP List
  "http://danger.rulez.sk/projects/bruteforceblocker/blist.php"

  # Spamhaus DROP List (IPv4) - Don't Route Or Peer
  "https://www.spamhaus.org/drop/drop.txt"

  # Spamhaus DROP List (IPv6)
  "https://www.spamhaus.org/drop/dropv6.txt"

  # C.I. Army Malicious IP List
  "https://cinsscore.com/list/ci-badguys.txt"

  # blocklist.de - All Attackers
  "https://lists.blocklist.de/lists/all.txt"

  # GreenSnow Blocklist
  "https://blocklist.greensnow.co/greensnow.txt"

  # FireHOL Level 1 (aggregated)
  "https://raw.githubusercontent.com/firehol/blocklist-ipsets/master/firehol_level1.netset"

  # StopForumSpam (7 days)
  "https://raw.githubusercontent.com/firehol/blocklist-ipsets/master/stopforumspam_7d.ipset"

  # Country/ASN blocks (uncomment and edit as needed)
  # Use https://lens.ipverse.net to look up ASN and network info
  # "https://raw.githubusercontent.com/ipverse/country-ip-blocks/master/country/ru/ipv4-aggregated.txt"
  #Â "https://raw.githubusercontent.com/ipverse/country-ip-blocks/master/country/ru/ipv6-aggregated.txt"
  # "https://raw.githubusercontent.com/ipverse/as-ip-blocks/master/as/64496/ipv4-aggregated.txt"
  # "https://raw.githubusercontent.com/ipverse/as-ip-blocks/master/as/64496/ipv6-aggregated.txt"
)

#=== WHITELIST ===#
# IPs/CIDRs that should NEVER be blocked (protects against self-blocking)

# Auto-detect and whitelist this server's IPs (default: no, recommended: yes)
# AUTO_WHITELIST=no

# Manual whitelist entries (IPv6 uses exact matching only)
WHITELIST=(
  # Add your server's IP and network here to prevent self-blocking
  # "203.0.113.10"       # Single IP
  # "203.0.113.0/24"     # CIDR range
  # "2001:db8::1"        # IPv6
)

#=== OPTIONAL OVERRIDES ===#
# Uncomment to change defaults:

# ENABLE_IPV4=yes
# ENABLE_IPV6=yes
# NFT_TABLE_NAME=blacklist
# NFT_SET_NAME_V4=blacklist4
# NFT_SET_NAME_V6=blacklist6
# NFT_CHAIN_PRIORITY=-200     # Lower = checked earlier
# BLOCK_FORWARD=no            # Also block in forward chain (e.g. for containers)
# CHUNK_SIZE=5000             # IPs per nft command
# CURL_CONNECT_TIMEOUT=10
# CURL_MAX_TIME=30
