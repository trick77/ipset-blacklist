# nftables-blacklist configuration
# https://github.com/trick77/ipset-blacklist
#
# Most settings have sensible defaults. Override only what you need.
# See README.md for all available options.

#=== FILE PATHS ===#
# Directory must exist (won't be created automatically)

IP_BLACKLIST=/etc/nftables-blacklist/ip-blacklist.list
NFT_BLACKLIST_SCRIPT=/etc/nftables-blacklist/blacklist.nft

#=== BEHAVIOR ===#

VERBOSE=yes    # Set to "no" for cron jobs
FORCE=yes      # Auto-create nftables table/sets if missing

#=== BLACKLISTS ===#
# URLs to download. Supports: https://, http://, file:///
# Both IPv4 and IPv6 addresses are automatically extracted

BLACKLISTS=(
    # Local custom list (uncomment to use)
    # "file:///etc/nftables-blacklist/custom.list"

    # Project Honey Pot - Dictionary Attacker IPs
    "https://www.projecthoneypot.org/list_of_ips.php?t=d&rss=1"

    # BruteForceBlocker IP List
    "http://danger.rulez.sk/projects/bruteforceblocker/blist.php"

    # Spamhaus DROP List (IPv4) - Don't Route Or Peer
    "https://www.spamhaus.org/drop/drop.txt"

    # Spamhaus DROP List (IPv6)
    "https://www.spamhaus.org/drop/dropv6.txt"

    # C.I. Army Malicious IP List
    "https://cinsscore.com/list/ci-badguys.txt"

    # blocklist.de - All Attackers
    "https://lists.blocklist.de/lists/all.txt"

    # GreenSnow Blocklist
    "https://blocklist.greensnow.co/greensnow.txt"

    # FireHOL Level 1 (aggregated)
    "https://raw.githubusercontent.com/firehol/blocklist-ipsets/master/firehol_level1.netset"

    # StopForumSpam (7 days)
    "https://raw.githubusercontent.com/firehol/blocklist-ipsets/master/stopforumspam_7d.ipset"

    # Country/ASN blocks (uncomment and edit as needed)
    # "https://raw.githubusercontent.com/ipverse/rir-ip/master/country/ru/ipv4-aggregated.txt"
    # "https://raw.githubusercontent.com/ipverse/asn-ip/master/as/64496/ipv4-aggregated.txt"
)

#=== OPTIONAL OVERRIDES ===#
# Uncomment to change defaults:

# ENABLE_IPV4=yes
# ENABLE_IPV6=yes
# NFT_TABLE_NAME=blacklist
# NFT_SET_NAME_V4=blocklist4
# NFT_SET_NAME_V6=blocklist6
# NFT_CHAIN_PRIORITY=-200     # Lower = checked earlier
# CHUNK_SIZE=5000             # IPs per nft command
# CURL_CONNECT_TIMEOUT=10
# CURL_MAX_TIME=30

# CIDR optimization is automatic if 'iprange' is installed:
#   apt install iprange
